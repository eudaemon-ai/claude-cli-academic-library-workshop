import{a as m,f as h,c as z}from"../chunks/BzzAkpJO.js";import{c as i,r,s as o,t as A,g as t,u as N,p as J,a as U,f as F,ax as B,I as R,G as Z,U as ce,b3 as ve,n as ue}from"../chunks/CKmK40wl.js";import{s as S,i as w,d as L,a as H}from"../chunks/gAHvPrMa.js";import{e as $,r as me,s as W,i as ee}from"../chunks/DEdCDX_L.js";import{h as G}from"../chunks/BeRtFN0D.js";import{g as X,a as xe}from"../chunks/Ucc0UpXt.js";import"../chunks/3q588-QB.js";import{S as ge}from"../chunks/DxLu1ZwN.js";import{s as pe}from"../chunks/DXPvdZ8x.js";import{s as be}from"../chunks/NLV7PxwD.js";import{s as Y}from"../chunks/Dpdp6QWd.js";import{a as fe,b as he}from"../chunks/CLS1klCa.js";var ye=h('<div class="mb-8 pb-6 border-b border-gray-200"><h1 class="font-serif text-2xl font-bold leading-snug text-jhu-blue"> </h1> <div class="mt-4 flex items-center gap-3"><div class="h-1 flex-1 rounded-full bg-gray-200"><div class="h-1 rounded-full bg-jhu-blue transition-all duration-300"></div></div> <span class="text-xs tabular-nums text-gray-400"> </span> <span class="text-xs text-gray-400">Â·</span> <span class="text-xs text-gray-400"> </span></div></div>');function _e(_,e){const a=N(()=>e.totalSteps>0?e.currentStep/e.totalSteps*100:0);var s=ye(),n=i(s),p=i(n,!0);r(n);var b=o(n,2),y=i(b),k=i(y);r(y);var u=o(y,2),j=i(u);r(u);var x=o(u,4),g=i(x);r(x),r(b),r(s),A(()=>{S(p,e.title),pe(k,`width: ${t(a)??""}%`),S(j,`${e.currentStep??""}/${e.totalSteps??""} steps`),S(g,`~${e.estimatedMinutes??""} min`)}),m(_,s)}var ke=h('<span class="ml-auto text-xs text-gray-400">Locked</span>'),Ce=h('<div><div class="mb-5 flex items-center gap-3"><span> </span> <h3> </h3> <!></div> <!></div>');function we(_,e){J(e,!0);var a=Ce(),s=i(a),n=i(s),p=i(n,!0);r(n);var b=o(n,2),y=i(b,!0);r(b);var k=o(b,2);{var u=g=>{var v=ke();m(g,v)};w(k,g=>{!e.isActive&&!e.isComplete&&g(u)})}r(s);var j=o(s,2);{var x=g=>{var v=z(),d=F(v);be(d,()=>e.children),m(g,v)};w(j,g=>{(e.isActive||e.isComplete)&&g(x)})}r(a),A(()=>{Y(a,1,`rounded-xl border bg-white p-6 transition-all
		${e.isComplete?"border-green-200 opacity-80":e.isActive?"border-jhu-blue/40 shadow-sm ring-1 ring-jhu-blue/10":"border-gray-200 opacity-50"}`),Y(n,1,`flex h-7 w-7 shrink-0 items-center justify-center rounded-full text-xs font-bold tabular-nums
			${e.isComplete?"bg-green-500 text-white":e.isActive?"bg-jhu-blue text-white":"bg-gray-200 text-gray-500"}`),S(p,e.isComplete?"âœ“":e.step.index+1),Y(b,1,`text-[0.9375rem] font-semibold leading-snug tracking-tight
			${e.isActive?"text-gray-900":e.isComplete?"text-gray-600":"text-gray-400"}`),S(y,e.step.label)}),m(_,a),U()}var je=h('<div class="mt-4 flex items-start gap-3 rounded-lg border border-green-200 bg-green-50 px-4 py-3"><span class="mt-0.5 text-green-600">âœ“</span> <div><p class="text-sm font-medium text-green-800">Checkpoint</p> <p class="mt-0.5 text-sm text-green-700"> </p></div></div>');function K(_,e){var a=je(),s=o(i(a),2),n=o(i(s),2),p=i(n,!0);r(n),r(s),r(a),A(()=>S(p,e.text)),m(_,a)}var Se=h('<p class="text-sm text-gray-500 italic"> </p>'),Ie=h('<div class="flex items-center gap-4"><!> <button class="ml-auto shrink-0 rounded-lg bg-gray-900 px-4 py-2 text-sm font-medium text-white hover:bg-gray-700">Mark Complete â†’</button></div>'),Ae=h('<div class="space-y-3"><div class="mb-1 flex items-center gap-2"><span class="rounded-md bg-gray-900/8 px-2 py-0.5 font-mono text-[11px] font-medium tracking-wide text-gray-500">TERMINAL</span></div> <div class="prose prose-sm max-w-none rounded-lg bg-gray-900 p-4 text-gray-100 font-mono text-sm leading-relaxed"><!></div> <!> <!></div>');function Te(_,e){J(e,!0);var a=Ae(),s=o(i(a),2),n=i(s);G(n,()=>e.step.instruction),r(s);var p=o(s,2);{var b=u=>{K(u,{get text(){return e.step.checkpoint}})};w(p,u=>{e.isComplete&&e.step.checkpoint&&u(b)})}var y=o(p,2);{var k=u=>{var j=Ie(),x=i(j);{var g=d=>{var l=Se(),c=i(l,!0);r(l),A(()=>S(c,e.step.checkpoint)),m(d,l)};w(x,d=>{e.step.checkpoint&&d(g)})}var v=o(x,2);r(j),H("click",v,function(...d){e.onComplete?.apply(this,d)}),m(u,j)};w(y,u=>{e.isComplete||u(k)})}r(a),m(_,a),U()}L(["click"]);var Ee=h('<button title="Copy to clipboard"> </button>');function De(_,e){let a=B(!1);async function s(){await navigator.clipboard.writeText(e.text),R(a,!0),setTimeout(()=>R(a,!1),2e3)}var n=Ee(),p=i(n,!0);r(n),A(()=>{Y(n,1,`rounded px-2 py-1 text-xs font-medium transition-colors
		${t(a)?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`),S(p,t(a)?"âœ“ Copied":"Copy")}),H("click",n,s),m(_,n)}L(["click"]);var Me=h('<div class="relative rounded-lg border border-jhu-blue/20 bg-jhu-blue/5"><div class="absolute right-2 top-2"><!></div> <pre class="overflow-x-auto whitespace-pre-wrap p-4 pr-16 font-mono text-sm leading-relaxed text-jhu-blue"> </pre></div>'),Ne=h('<p class="text-sm leading-relaxed text-gray-500 italic"> </p>'),Oe=h('<div class="flex items-center gap-4 pt-1"><!> <button class="ml-auto shrink-0 rounded-lg bg-jhu-blue px-4 py-2 text-sm font-medium text-white hover:bg-blue-950">Mark Complete â†’</button></div>'),Pe=h('<div class="space-y-3.5"><div class="mb-1"><span class="rounded-md bg-jhu-blue/8 px-2 py-0.5 font-mono text-[11px] font-medium tracking-wide text-jhu-blue">CLAUDE PROMPT</span></div> <div class="prose prose-sm max-w-none leading-relaxed text-gray-700"><!></div> <!> <!> <!></div>');function Re(_,e){J(e,!0);var a=Pe(),s=o(i(a),2),n=i(s);G(n,()=>e.step.instruction),r(s);var p=o(s,2);{var b=x=>{var g=Me(),v=i(g),d=i(v);De(d,{get text(){return e.step.prompt_text}}),r(v);var l=o(v,2),c=i(l,!0);r(l),r(g),A(C=>S(c,C),[()=>e.step.prompt_text.trim()]),m(x,g)};w(p,x=>{e.step.prompt_text&&x(b)})}var y=o(p,2);{var k=x=>{K(x,{get text(){return e.step.checkpoint}})};w(y,x=>{e.isComplete&&e.step.checkpoint&&x(k)})}var u=o(y,2);{var j=x=>{var g=Oe(),v=i(g);{var d=c=>{var C=Ne(),I=i(C,!0);r(C),A(()=>S(I,e.step.checkpoint)),m(c,C)};w(v,c=>{e.step.checkpoint&&c(d)})}var l=o(v,2);r(g),H("click",l,function(...c){e.onComplete?.apply(this,c)}),m(x,g)};w(u,x=>{e.isComplete||x(j)})}r(a),m(_,a),U()}L(["click"]);var He=h('<li class="flex items-start gap-3"><input type="checkbox" class="mt-0.5 h-4 w-4 rounded border-gray-300 text-jhu-gold focus:ring-jhu-gold/50"/> <label class="text-sm leading-relaxed text-gray-700"> </label></li>'),Le=h('<ul class="space-y-2.5"></ul>'),Be=h('<button class="rounded-lg bg-[#D4870A] px-4 py-2 text-sm font-medium text-white hover:bg-[#b8720a] disabled:cursor-not-allowed disabled:opacity-40"> </button>'),Je=h('<div class="space-y-3.5"><div class="mb-1"><span class="rounded-md bg-[#D4870A]/10 px-2 py-0.5 font-mono text-[11px] font-medium tracking-wide text-[#A0620A]">OBSERVE</span></div> <p class="text-sm leading-relaxed text-gray-700"> </p> <!> <!> <!></div>');function Ue(_,e){J(e,!0);let a=B(Z([]));ce(()=>{e.step.observe_items&&R(a,e.step.observe_items.map(()=>!1),!0)});const s=N(()=>t(a).length>0&&t(a).every(Boolean));var n=Je(),p=o(i(n),2),b=i(p,!0);r(p);var y=o(p,2);{var k=v=>{var d=Le();$(d,21,()=>e.step.observe_items,ee,(l,c,C)=>{var I=He(),E=i(I);me(E),W(E,"id",`obs-${C}`);var O=o(E,2);W(O,"for",`obs-${C}`);var P=i(O,!0);r(O),r(I),A(()=>{E.disabled=e.isComplete,S(P,t(c))}),fe(E,()=>t(a)[C],V=>t(a)[C]=V),m(l,I)}),r(d),m(v,d)};w(y,v=>{e.step.observe_items&&v(k)})}var u=o(y,2);{var j=v=>{K(v,{get text(){return e.step.checkpoint}})};w(u,v=>{e.isComplete&&e.step.checkpoint&&v(j)})}var x=o(u,2);{var g=v=>{var d=Be(),l=i(d,!0);r(d),A(()=>{d.disabled=!t(s),S(l,t(s)?"Mark Complete â†’":"Check all items to continue")}),H("click",d,function(...c){e.onComplete?.apply(this,c)}),m(v,d)};w(x,v=>{e.isComplete||v(g)})}r(n),A(()=>S(b,e.step.instruction)),m(_,n),U()}L(["click"]);var Ye=h('<p class="rounded-lg border border-jhu-spirit/30 bg-jhu-spirit/8 px-4 py-3.5 text-sm leading-relaxed text-jhu-blue italic"> </p>'),Fe=h('<textarea rows="4" placeholder="Your thoughtsâ€¦ (optional)" class="w-full rounded-lg border border-gray-300 p-3 text-sm leading-relaxed focus:border-jhu-spirit focus:outline-none focus:ring-1 focus:ring-jhu-spirit/50"></textarea> <div class="flex gap-3 pt-1"><button class="rounded-lg bg-jhu-blue px-4 py-2 text-sm font-medium text-white hover:bg-blue-950 disabled:opacity-50"> </button> <button class="rounded-lg border border-gray-300 px-4 py-2 text-sm text-gray-600 hover:bg-gray-50">Skip</button></div>',1),Ge=h('<p class="text-sm text-gray-400 italic">Reflection recorded.</p>'),Ve=h('<div class="space-y-3.5"><div class="mb-1"><span class="rounded-md bg-jhu-spirit/15 px-2 py-0.5 font-mono text-[11px] font-medium tracking-wide text-[#1265A8]">REFLECT</span></div> <p class="text-sm leading-relaxed text-gray-700"> </p> <!> <!></div>');function qe(_,e){J(e,!0);const a=!1;let s=B(""),n=B(!1);async function p(){!t(s).trim()||a||(R(n,!0),await fetch("/api/notes",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({moduleId:e.moduleId,exerciseId:e.exerciseId,body:t(s)})}),R(n,!1))}var b=Ve(),y=o(i(b),2),k=i(y,!0);r(y);var u=o(y,2);{var j=d=>{var l=Ye(),c=i(l,!0);r(l),A(()=>S(c,e.step.reflection_prompt)),m(d,l)};w(u,d=>{e.step.reflection_prompt&&d(j)})}var x=o(u,2);{var g=d=>{var l=Fe(),c=F(l);ve(c);var C=o(c,2),I=i(C),E=i(I,!0);r(I);var O=o(I,2);r(C),A(()=>{I.disabled=t(n),S(E,t(n)?"Savingâ€¦":"Save & Continue â†’")}),he(c,()=>t(s),P=>R(s,P)),H("click",I,async()=>{await p(),e.onComplete()}),H("click",O,function(...P){e.onComplete?.apply(this,P)}),m(d,l)},v=d=>{var l=Ge();m(d,l)};w(x,d=>{e.isComplete?d(v,!1):d(g)})}r(b),A(()=>S(k,e.step.instruction)),m(_,b),U()}L(["click"]);var ze=h('<div class="flex min-h-[60vh] flex-col items-center justify-center px-6 py-16 text-center"><div class="mb-5 inline-flex h-14 w-14 items-center justify-center rounded-full bg-jhu-gold/15 text-2xl">ðŸ’¡</div> <h2 class="mb-2 font-serif text-3xl font-bold tracking-tight text-jhu-blue">Discovery Moment</h2> <p class="mb-8 max-w-md text-base leading-relaxed text-jhu-sable/70">You finished <strong class="font-semibold text-gray-800"> </strong>. Take a moment to discuss with your group.</p> <div class="mb-8 w-full max-w-2xl rounded-xl border border-jhu-gold/40 bg-jhu-gold/8 p-7 text-left"><div class="prose max-w-none text-gray-800"><!></div></div> <button class="rounded-xl bg-jhu-blue px-8 py-2.5 text-sm font-medium text-white hover:bg-blue-950">Continue to Next Exercise â†’</button></div>');function Ke(_,e){var a=ze(),s=o(i(a),4),n=o(i(s)),p=i(n,!0);r(n),ue(),r(s);var b=o(s,2),y=i(b),k=i(y);G(k,()=>e.discussionHtml),r(y),r(b);var u=o(b,2);r(a),A(()=>S(p,e.exerciseTitle)),H("click",u,function(...j){e.onContinue?.apply(this,j)}),m(_,a)}L(["click"]);var Qe=h('<div class="prose mb-8 max-w-none text-gray-600"><!></div>'),We=h('<div class="mt-8 rounded-xl border border-jhu-gold/40 bg-jhu-gold/8 p-6 text-center"><p class="font-semibold text-jhu-blue">Exercise complete!</p> <button class="mt-4 rounded-lg bg-jhu-blue px-6 py-2 font-medium text-white hover:bg-blue-950">Next Exercise â†’</button></div>'),Xe=h('<div class="flex"><!> <div class="flex-1 overflow-y-auto"><div class="mx-auto max-w-2xl px-10 py-10"><!> <!> <div class="space-y-4"></div> <!></div></div></div>');function vt(_,e){J(e,!0);const a=N(()=>e.data.exercise),s=N(()=>e.data.module);let n=B(Z(e.data.completedStepIndices)),p=B(!1);const b=N(()=>t(n).length<t(a).steps.length?t(n).length:t(a).steps.length-1),y=N(()=>t(n).length>=t(a).steps.length);async function k(l){await fetch("/api/progress",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({moduleId:t(s).id,exerciseId:t(a).id,stepIndex:l})}),R(n,[...t(n),l],!0),t(n).length>=t(a).steps.length&&(t(a).discovery_moment?R(p,!0):await u()),await xe("app:progress")}async function u(){const l=t(s).exercises.findIndex(C=>C.id===t(a).id),c=t(s).exercises[l+1];c?await X(`/learn/${t(s).id}/${c.id}`):await X(`/learn/${t(s).id}`)}function j(l){const c=l.match(/<h2[^>]*>Discussion<\/h2>([\s\S]*?)(?=<h2|$)/i);return c?`<h2>Discussion</h2>${c[1]}`:l}var x=z(),g=F(x);{var v=l=>{{let c=N(()=>j(t(a).body));Ke(l,{get exerciseTitle(){return t(a).title},get discussionHtml(){return t(c)},onContinue:u})}},d=l=>{var c=Xe(),C=i(c);ge(C,{get moduleId(){return t(s).id},get moduleTitle(){return t(s).title},get exercises(){return t(s).exercises},get currentExerciseId(){return t(a).id},get completedExerciseIds(){return e.data.completedExerciseIds}});var I=o(C,2),E=i(I),O=i(E);_e(O,{get title(){return t(a).title},get currentStep(){return t(n).length},get totalSteps(){return t(a).steps.length},get estimatedMinutes(){return t(a).estimated_minutes}});var P=o(O,2);{var V=D=>{var f=Qe(),M=i(f);G(M,()=>t(a).body.replace(/<h2[^>]*>Discussion<\/h2>[\s\S]*/i,"")),r(f),m(D,f)};w(P,D=>{t(a).body&&D(V)})}var q=o(P,2);$(q,21,()=>t(a).steps,ee,(D,f)=>{const M=N(()=>t(n).includes(t(f).index)),re=N(()=>t(f).index===t(b)&&!t(y)||t(f).index===t(b));we(D,{get step(){return t(f)},get isComplete(){return t(M)},get isActive(){return t(re)},children:(ie,Ze)=>{var Q=z(),se=F(Q);{var ne=T=>{Te(T,{get step(){return t(f)},get isComplete(){return t(M)},onComplete:()=>k(t(f).index)})},oe=T=>{Re(T,{get step(){return t(f)},get isComplete(){return t(M)},onComplete:()=>k(t(f).index)})},le=T=>{Ue(T,{get step(){return t(f)},get isComplete(){return t(M)},onComplete:()=>k(t(f).index)})},de=T=>{qe(T,{get step(){return t(f)},get moduleId(){return t(s).id},get exerciseId(){return t(a).id},get isComplete(){return t(M)},onComplete:()=>k(t(f).index)})};w(se,T=>{t(f).type==="terminal"?T(ne):t(f).type==="prompt"?T(oe,1):t(f).type==="observe"?T(le,2):t(f).type==="reflect"&&T(de,3)})}m(ie,Q)},$$slots:{default:!0}})}),r(q);var te=o(q,2);{var ae=D=>{var f=We(),M=o(i(f),2);r(f),H("click",M,u),m(D,f)};w(te,D=>{t(y)&&!t(a).discovery_moment&&D(ae)})}r(E),r(I),r(c),m(l,c)};w(g,l=>{t(p)?l(v):l(d,!1)})}m(_,x),U()}L(["click"]);export{vt as component};
